## 任务

基于永续合约k线创建分析模型：市场广度分析。

对应模块：`notebooks/market_breadth/analysis.py`。

## 背景和目标

分析模型能够产生有价值的市场洞察，还需要生成美观的表格和图表，作为内容营销的资料（推特，币安广场，博客平台）。

广度指标(Breadth indicator)，度量交易所中上涨股票数量和下跌股票数量的相对变化，通常用于衡量市场情绪，或整体趋势强弱。

核心指标：
1. 腾落线（A/D Line）：每日（上涨股票数量 - 下跌股票数量）的累加值。
2. 均线以上占比：价格高于特定均线（如200天）的股票比例。

## 核心逻辑

- 设定20个主流交易对，例如`BTCUSDT`,`ETHUSDT`,`BNBUSDT`等。
- 用户选择参数：均线回溯期（默认50），开始时间，结束时间（默认现在），k线周期（小时图，四小时图，日图，默认日图）
- 用户点击按钮，执行计算。
  - 从本地数据库读取数据（`data/cleaned/binance_klines_perp_m1/symbol=BTCUSDT/period=202601/data.parquet`）。
  - 将分钟图数据进行重采样。
  - 计算市场广度指标：价格高于特定均线的交易对比例。
- 创建可视化图表。

如果用户不点击按钮，不要进行计算。

## 技术约束

1. 使用`marimo notebook`创建交互式notebook。
2. 使用`duckdb`作为查询引擎。
3. 使用`pandas`操作数据和计算均线。
4. 使用`altair`创建图表。
5. 使用函数封装读取，计算和绘图逻辑，遵循marimo notebook最优实践。
6. 使用更现代的类型提示，例如`list[str]`而不是`List[str]`。
7. 文档字符串和注释均使用中文。
