## 任务

重构币安永续合约k线数据管道的代码。

## 背景/目标

数据管道代码：`src/pipelines/binance_klines`，主入口文件是`task.py`。

代码能够正常工作，但是核心逻辑不满足实战需求。主要问题：并发下载数百个交易对的k线时，总是会出现下载失败的情况，但是程序并没有收集下载失败的信息并进行补漏下载。导致历史数据和增量数据都有缺失。

## 核心逻辑

下载历史数据：
- 从本地文件读取活跃交易对和上市日期
- 下载数据，存储到本地，按交易对+月份分区（依然使用多线程实现）
- 记录失败的组合
- 第一轮下载完毕后，如果存在失败组合，进行重试，直到全部成功或者达到最大重试次数为止
- 流程全部结束后生成一份表格，记录下载细节

`fetch_historical`：如果出现`404 client error`，表明历史仓库不存在数据，这时候应该抛出自定义异常，明确告知用户数据不存在，而且这是月份不应该记录到失败记录中，而是应该直接跳过。

创建自定义类来管理历史数据下载和增量数据更新，类的设计应该符合数据管道的最优设计逻辑，同时要满足该项目需求。我想将配置信息（例如路径）作为类属性。

## 技术约束

继续使用当前的技术栈。
